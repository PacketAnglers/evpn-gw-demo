---
# --------------------------------------------------------------
# Arista EVPN Gateway Demo
# --------------------------------------------------------------

name: arista-evpn-dg

prefix: ""

mgmt:
  network: mgmt
  ipv4-subnet: 172.100.100.0/24

topology:

  defaults:
    env:
      INTFTYPE: et

  kinds:
    ceos:
      image: ceos:latest
      env:
        CLAB_MGMT_VRF: MGMT
    linux:
      image: ghcr.io/aristanetworks/aclabs/host-ubuntu:rev1.0

  nodes:

    A-SPINE:
      kind: ceos
      mgmt-ipv4: 172.100.100.101
      binds:
        - sn/a-spine.txt:/mnt/flash/ceos-config:ro
      # startup-config: init-configs/A-SPINE.cfg
      ports:
        - '22001:22'
        - '8001:80'
        - '44301:443'
      image: ceos:latest

    A-LEAF:
      kind: ceos
      mgmt-ipv4: 172.100.100.102
      binds:
        - sn/a-leaf.txt:/mnt/flash/ceos-config:ro
      # startup-config: init-configs/A-LEAF.cfg
      ports:
        - '22002:22'
        - '8002:80'
        - '44302:443'
      image: ceos:latest

    A-BORDER-1:
      kind: ceos
      mgmt-ipv4: 172.100.100.103
      binds:
        - sn/a-border-1.txt:/mnt/flash/ceos-config:ro
      # startup-config: init-configs/A-BORDER-1.cfg
      ports:
        - '22003:22'
        - '8003:80'
        - '44303:443'
      image: ceos:latest

    A-BORDER-2:
      kind: ceos
      mgmt-ipv4: 172.100.100.104
      binds:
        - sn/a-border-2.txt:/mnt/flash/ceos-config:ro
      # startup-config: init-configs/A-BORDER-2.cfg
      ports:
        - '22004:22'
        - '8004:80'
        - '44304:443'
      image: ceos:latest

    B-SPINE:
      kind: ceos
      mgmt-ipv4: 172.100.100.105
      binds:
        - sn/b-spine.txt:/mnt/flash/ceos-config:ro
      # startup-config: init-configs/B-SPINE.cfg
      ports:
        - '22005:22'
        - '8005:80'
        - '44305:443'
      image: ceos:latest

    B-LEAF:
      kind: ceos
      mgmt-ipv4: 172.100.100.106
      binds:
        - sn/b-leaf.txt:/mnt/flash/ceos-config:ro
      # startup-config: init-configs/B-LEAF.cfg
      ports:
        - '22006:22'
        - '8006:80'
        - '44306:443'
      image: ceos:latest

    B-BORDER-1:
      kind: ceos
      mgmt-ipv4: 172.100.100.107
      binds:
        - sn/b-border-1.txt:/mnt/flash/ceos-config:ro
      # startup-config: init-configs/B-BORDER-1.cfg
      ports:
        - '22007:22'
        - '8007:80'
        - '44307:443'
      image: ceos:latest

    B-BORDER-2:
      kind: ceos
      mgmt-ipv4: 172.100.100.108
      binds:
        - sn/b-border-2.txt:/mnt/flash/ceos-config:ro
      # startup-config: init-configs/B-BORDER-2.cfg
      ports:
        - '22008:22'
        - '8008:80'
        - '44308:443'
      image: ceos:latest

    DCI-MPLS:
      kind: ceos
      mgmt-ipv4: 172.100.100.109
      binds:
        - sn/dci-mpls.txt:/mnt/flash/ceos-config:ro
      # startup-config: init-configs/DCI-MPLS.cfg
      ports:
        - '22009:22'
        - '8009:80'
        - '44309:443'
      image: ceos:latest

    HostA1:
      kind: linux
      mgmt-ipv4: 172.100.100.201
      env:
        IPV4: 10.10.10.101/24
        STATIC_ROUTE: 10.0.0.0/8
        GW: 10.10.10.1
        IPV6: 2001:db8:10:10::101/64
      ports:
        - '22201:22'
      image: ghcr.io/aristanetworks/aclabs/host-ubuntu:rev1.0

    HostA2:
      kind: linux
      mgmt-ipv4: 172.100.100.202
      env:
        IPV4: 10.20.20.101/24
        STATIC_ROUTE: 10.0.0.0/8
        GW: 10.20.20.1
        IPV6: 2001:db8:20:20::101/64
      ports:
        - '22202:22'
      image: ghcr.io/aristanetworks/aclabs/host-ubuntu:rev1.0

    HostB1:
      kind: linux
      mgmt-ipv4: 172.100.100.203
      env:
        IPV4: 10.10.10.102/24
        STATIC_ROUTE: 10.0.0.0/8
        GW: 10.10.10.1
        IPV6: 2001:db8:10:10::101/64
      ports:
        - '22203:22'
      image: ghcr.io/aristanetworks/aclabs/host-ubuntu:rev1.0

    HostB2:
      kind: linux
      mgmt-ipv4: 172.100.100.204
      env:
        IPV4: 10.30.30.101/24
        STATIC_ROUTE: 10.0.0.0/8
        GW: 10.30.30.1
        IPV6: 2001:db8:30:30::101/64
      ports:
        - '22204:22'
      image: ghcr.io/aristanetworks/aclabs/host-ubuntu:rev1.0

  links:
    - endpoints: [ A-SPINE:et1, A-LEAF:et1 ]
    - endpoints: [ A-SPINE:et2, A-BORDER-1:et1 ]
    - endpoints: [ A-SPINE:et3, A-BORDER-2:et1 ]
    - endpoints: [ A-BORDER-1:et2, DCI-MPLS:et1 ]
    - endpoints: [ A-BORDER-2:et2, DCI-MPLS:et2 ]
    - endpoints: [ B-BORDER-1:et2, DCI-MPLS:et3 ]
    - endpoints: [ B-BORDER-2:et2, DCI-MPLS:et4 ]
    - endpoints: [ B-SPINE:et1, B-LEAF:et1 ]
    - endpoints: [ B-SPINE:et2, B-BORDER-1:et1 ]
    - endpoints: [ B-SPINE:et3, B-BORDER-2:et1 ]
    - endpoints: [ HostA1:eth1, A-LEAF:et2 ]
    - endpoints: [ HostA2:eth1, A-LEAF:et3 ]
    - endpoints: [ HostB1:eth1, B-LEAF:et2 ]
    - endpoints: [ HostB2:eth1, B-LEAF:et3 ]
